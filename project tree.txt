jassist-assist-google/
│
├── .venv/                           # Virtual environment
│
├── jassist/
│   └── web/
│       ├── credentials/             # Stores credentials (not in version control)
│       │   └── users/               # Per-user credential storage
│       │
│       ├── diary_project/           # Django project settings
│       │   ├── __init__.py
│       │   ├── credentials.py       # Credential management
│       │   ├── settings.py          # Main Django settings
│       │   ├── urls.py              # Project URL configuration
│       │   └── wsgi.py              # WSGI configuration
│       │
│       ├── download_gdrive/         # Google Drive download module
│       │   ├── __init__.py
│       │   ├── admin.py             # Admin interface
│       │   ├── apps.py              # App configuration
│       │   ├── forms.py             # Form definitions
│       │   ├── gdrive_utils.py      # Drive utilities
│       │   ├── models.py            # Drive download models
│       │   ├── urls.py              # URL routing
│       │   ├── views.py             # View controllers
│       │   ├── README_download_gdrive.md  # Module documentation
│       │   │
│       │   ├── management/          # Django management commands
│       │   │   └── commands/
│       │   │       ├── __init__.py
│       │   │       ├── reset_transcription_configs.py  # Reset configs
│       │   │       └── run_scheduled_downloads.py      # Scheduled downloads
│       │   │
│       │   ├── migrations/          # Database migrations
│       │   │
│       │   ├── services/            # Core services
│       │   │   ├── __init__.py
│       │   │   ├── downloader.py    # Legacy file download implementation (wrapper)
│       │   │   ├── transcriber.py   # Legacy voice transcription implementation (wrapper)
│       │   │   │
│       │   │   ├── download/        # Modular download implementation
│       │   │   │   ├── __init__.py  # Package documentation
│       │   │   │   ├── download_manager.py       # Orchestration layer
│       │   │   │   ├── google_drive_client.py    # API communication
│       │   │   │   ├── file_filter.py            # Filtering logic
│       │   │   │   ├── file_downloader.py        # Download processing
│       │   │   │   ├── file_system_handler.py    # File operations
│       │   │   │   └── schedule_evaluator.py     # Schedule management
│       │   │   │
│       │   │   └── transcription/   # Modular transcription implementation
│       │   │       ├── __init__.py  # Package documentation
│       │   │       ├── transcription_manager.py  # Orchestration layer
│       │   │       ├── audio_preprocessor.py     # Audio validation/preparation
│       │   │       ├── openai_client.py          # OpenAI API communication
│       │   │       ├── result_processor.py       # Result formatting
│       │   │       └── metrics_collector.py      # Usage metrics
│       │   │
│       │   ├── templates/           # HTML templates
│       │   │   └── download_gdrive/
│       │   │       ├── __init__.py
│       │   │       ├── configure.html                # Download config
│       │   │       ├── configure_transcription.html  # Transcription config
│       │   │       ├── dashboard.html                # Main dashboard
│       │   │       └── history.html                  # Download history
│       │   │
│       │   └── utils/               # Utility functions
│       │
│       ├── jassist_app/             # Main app module
│       │   ├── __init__.py
│       │   ├── adapters.py          # OAuth adapters
│       │   ├── apps.py              # App configuration
│       │   ├── tests.py             # Test cases
│       │   ├── urls.py              # URL configuration
│       │   ├── views.py             # View controllers
│       │   ├── README_jassist_app.md  # Module documentation
│       │   │
│       │   ├── management/          # Django management commands
│       │   │   └── commands/
│       │   │       ├── __init__.py
│       │   │       └── fix_google_auth.py  # Google auth configuration
│       │   │
│       │   ├── migrations/          # Database migrations
│       │   │
│       │   ├── services/            # Service layer
│       │   │   ├── __init__.py
│       │   │   └── google_apis.py   # Google API integrations
│       │   │
│       │   └── templates/           # HTML templates
│       │       └── jassist_app/
│       │           ├── base.html    # Base template
│       │           ├── login.html   # Login page
│       │           ├── profile.html # User profile
│       │           └── success.html # Success page
│       │
│       ├── logs/                    # Application logs
│       │   └── transcription_metrics/  # Transcription usage metrics
│       │
│       ├── media/                   # User-uploaded media
│       │   ├── downloads/           # Downloaded files
│       │   │   └── drive/           # Files from Google Drive
│       │   └── transcriptions/      # Voice transcription results
│       │
│       ├── static/                  # Static assets (CSS, JS, etc.)
│       │
│       ├── staticfiles/             # Collected static files
│       │
│       ├── favicon.ico              # Site favicon
│       └── manage.py                # Django management script
│
├── .gitignore                       # Git ignore configuration
├── database_migration_steps.txt     # Database migration instructions
├── README.md                        # Project documentation
├── refactoring_plan.md              # Refactoring planning document
├── refactoring_summary.md           # Refactoring documentation
├── requirements.txt                 # Python dependencies
├── refactoring_summary.md           # Refactoring documentation
├── tests_refactor.py                # Refactoring tests


# Voice Diary Project Database Schema

## User Authentication & Core Tables
┌─────────────────────────┐
│ User (Django Built-in)  │
├─────────────────────────┤
│ id (PK)                 │
│ username                │
│ email                   │
│ password                │
│ first_name              │
│ last_name               │
│ is_active               │
│ is_staff                │
│ is_superuser            │
│ date_joined             │
│ last_login              │
└───────────┬─────────────┘
            │
            │ 1
            ▼ 1..n
┌─────────────────────────┐
│ SocialAccount           │
│ (allauth)               │
├─────────────────────────┤
│ id (PK)                 │
│ user (FK → User)        │
│ provider                │
│ uid                     │
│ last_login              │
│ date_joined             │
│ extra_data              │
└───────────┬─────────────┘
            │
            │ 1
            ▼ 1..n
┌─────────────────────────┐
│ SocialToken             │
│ (allauth)               │
├─────────────────────────┤
│ id (PK)                 │
│ account (FK)            │
│ token                   │
│ token_secret            │
│ expires_at              │
└─────────────────────────┘

## Google Drive Module Tables
┌─────────────────────────┐      ┌─────────────────────────┐
│ GlobalDriveConfig       │      │ UserDriveConfig         │
├─────────────────────────┤      ├─────────────────────────┤
│ id (PK)                 │      │ id (PK)                 │
│ include_extensions      │      │ user (FK → User) (1:1)  │
│ delete_after_download   │      │ target_folders          │
│ add_timestamp           │      │ download_schedule       │
│ timestamp_format        │      │ is_active               │
│ created_at              │      │ last_run                │
│ updated_at              │      │ created_at              │
└─────────────────────────┘      │ updated_at              │
                                  └───────────┬─────────────┘
                                              │
                                              │ 1
                                              ▼ n
┌─────────────────────────┐
│ DownloadRecord          │
├─────────────────────────┤
│ id (PK)                 │
│ user (FK → User)        │
│ filename                │
│ source_id               │
│ source_folder           │
│ local_path              │
│ downloaded_at           │
│ deleted_from_drive      │
│ file_size               │
└─────────────────────────┘

## Transcription Module Tables
┌─────────────────────────┐      ┌─────────────────────────┐
│ TranscriptionGlobalConfig│      │ UserTranscriptionConfig │
├─────────────────────────┤      ├─────────────────────────┤
│ id (PK)                 │      │ id (PK)                 │
│ default_model           │      │ user (FK → User) (1:1)  │
│ response_format         │      │ api_key (encrypted)     │
│ cost_management         │      │ language                │
│ default_prompt          │      │ is_active               │
│ timestamp_format        │      │ created_at              │
│ created_at              │      │ updated_at              │
│ updated_at              │      └─────────────────────────┘
└─────────────────────────┘

## Django Framework Tables
┌─────────────────────────┐      ┌─────────────────────────┐
│ Site                    │      │ Session                 │
├─────────────────────────┤      ├─────────────────────────┤
│ id (PK)                 │      │ session_key (PK)        │
│ domain                  │      │ session_data            │
│ name                    │      │ expire_date             │
└─────────────────────────┘      └─────────────────────────┘

# RELATIONSHIPS:
# - User → UserDriveConfig (1:1)
# - User → UserTranscriptionConfig (1:1)
# - User → DownloadRecord (1:n)
# - User → SocialAccount (1:n)
# - SocialAccount → SocialToken (1:n)

